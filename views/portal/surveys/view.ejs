<%- include('../../partials/portal-header', { currentPage: 'surveys', pageTitle: 'Survey Details' }) %>

<div class="page-actions">
  <a href="/portal/surveys" class="btn btn-outline">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
    Back to Surveys
  </a>
  <% if (user && user.role === 'Admin') { %>
    <a href="/portal/surveys/<%= survey.SurveyID %>/edit" class="btn btn-primary">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
      Edit
    </a>
  <% } %>
</div>

<div class="detail-grid detail-grid--two">
  <!-- Main Info Card -->
  <div class="detail-card">
    <div class="card-header">
      <h3>Survey Information</h3>
    </div>
    
    <div class="detail-section">
      <dl class="detail-list">
        <dt>Survey Date</dt>
        <dd><%= survey.SurveySubmissionDate ? new Date(survey.SurveySubmissionDate).toLocaleDateString() : '-' %></dd>
        <dt>Event</dt>
        <dd><%- survey.event_title ? '<a href="/portal/events/' + survey.EventID + '">' + survey.event_title + '</a>' : 'N/A' %></dd>
        <dt>Participant</dt>
        <dd><%- survey.ParticipantFirstName ? '<a href="/portal/participants/' + survey.ParticipantID + '">' + survey.ParticipantFirstName + ' ' + survey.ParticipantLastName + '</a>' : 'Anonymous' %></dd>
      </dl>
    </div>
  </div>
  
  <!-- Scores Card -->
  <div class="detail-card">
    <div class="card-header">
      <h3>Scores</h3>
    </div>
    
    <div class="scores-display">
      <div class="score-item-large">
        <div class="score-circle score-<%= survey.SurveySatisfactionScore >= 4 ? 'high' : survey.SurveySatisfactionScore >= 3 ? 'medium' : 'low' %>">
          <%= survey.SurveySatisfactionScore || 0 %>
        </div>
        <span class="score-label">Satisfaction</span>
        <span class="score-max">/5</span>
      </div>
      
      <div class="score-item-large">
        <div class="score-circle score-<%= survey.SurveyUsefulnessScore >= 4 ? 'high' : survey.SurveyUsefulnessScore >= 3 ? 'medium' : 'low' %>">
          <%= survey.SurveyUsefulnessScore || 0 %>
        </div>
        <span class="score-label">Usefulness</span>
        <span class="score-max">/5</span>
      </div>
      
      <div class="score-item-large">
        <div class="score-circle score-<%= survey.SurveyRecommendationScore >= 4 ? 'high' : survey.SurveyRecommendationScore >= 3 ? 'medium' : 'low' %>">
          <%= survey.SurveyRecommendationScore || 0 %>
        </div>
        <span class="score-label">NPS</span>
        <span class="score-max">/5</span>
      </div>
    </div>
  </div>
  
  <!-- Feedback Card -->
  <div class="detail-card detail-card--wide">
    <div class="card-header">
      <h3>Written Feedback</h3>
    </div>
    
    <% if (survey.SurveyComments) { %>
    <div class="detail-section">
      <h4>Comments</h4>
      <p class="feedback-text"><%= survey.SurveyComments %></p>
    </div>
    <% } else { %>
      <p class="no-data">No written feedback provided</p>
    <% } %>
  </div>
</div>

<%- include('../../partials/portal-footer') %>

