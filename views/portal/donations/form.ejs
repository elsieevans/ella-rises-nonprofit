<%- include('../../partials/portal-header', { currentPage: 'donations', pageTitle: isEdit ? 'Edit Donation' : 'Add Donation' }) %>

<div class="page-actions">
  <a href="/portal/donations" class="btn btn-outline">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
    Back to Donations
  </a>
</div>

<div class="form-card">
  <form action="/portal/donations<%= isEdit ? '/' + donation.DonationID : '' %>" method="POST" class="crud-form">
    <div class="form-section">
      <h3>Donor Information</h3>
      
      <div class="form-group">
        <label for="participant_id">Participant <span class="required">*</span></label>
        <select id="participant_id" name="participant_id" required>
          <option value="">Select a participant...</option>
          <% participants.forEach(p => { %>
            <option value="<%= p.ParticipantID %>" <%= (donation.ParticipantID == p.ParticipantID) ? 'selected' : '' %>>
              <%= p.ParticipantLastName %>, <%= p.ParticipantFirstName %>
            </option>
          <% }) %>
        </select>
      </div>
    </div>
    
    <div class="form-section">
      <h3>Donation Details</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="amount">Amount <span class="required">*</span></label>
          <div class="input-with-prefix">
            <span class="input-prefix">$</span>
            <input type="number" id="amount" name="amount" value="<%= donation.DonationAmount || '' %>" step="0.01" min="0" required>
          </div>
        </div>
        <div class="form-group">
          <label for="donation_date">Date <span class="required">*</span></label>
          <input type="date" id="donation_date" name="donation_date" value="<%= donation.DonationDate ? new Date(donation.DonationDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0] %>" required>
        </div>
      </div>
      
      <div class="form-group">
        <label for="donation_no">Donation Number</label>
        <input type="number" id="donation_no" name="donation_no" value="<%= donation.DonationNo || '' %>" min="1">
      </div>
    </div>
    
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        <%= isEdit ? 'Update Donation' : 'Add Donation' %>
      </button>
      <a href="/portal/donations" class="btn btn-outline">Cancel</a>
    </div>
  </form>
</div>

<%- include('../../partials/portal-footer') %>

