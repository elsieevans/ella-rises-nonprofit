<%- include('../../partials/portal-header', { currentPage: 'milestones', pageTitle: isEdit ? 'Edit Milestone' : 'Add Milestone' }) %>

<div class="page-actions">
  <a href="/portal/milestones" class="btn btn-outline">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
    Back to Milestones
  </a>
</div>

<div class="form-card">
  <form action="/portal/milestones<%= isEdit ? '/' + milestone.MilestoneID : '' %>" method="POST" class="crud-form">
    <div class="form-section">
      <h3>Milestone Details</h3>
      
      <div class="form-group">
        <label for="participant_id">Participant <span class="required">*</span></label>
        <select id="participant_id" name="participant_id" required>
          <option value="">Select a participant...</option>
          <% participants.forEach(p => { %>
            <option value="<%= p.ParticipantID %>" <%= milestone.ParticipantID == p.ParticipantID ? 'selected' : '' %>>
              <%= p.ParticipantFirstName %> <%= p.ParticipantLastName %>
            </option>
          <% }) %>
        </select>
      </div>
      
      <div class="form-group">
        <label for="title">Milestone Title <span class="required">*</span></label>
        <input type="text" id="title" name="title" value="<%= milestone.MilestoneTitle || '' %>" required placeholder="e.g., First Job Interview, Completed GED">
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="date">Date</label>
          <input type="date" id="date" name="date" value="<%= milestone.MilestoneDate ? new Date(milestone.MilestoneDate).toISOString().split('T')[0] : '' %>">
        </div>
        <div class="form-group">
          <label for="milestone_no">Milestone Number</label>
          <input type="number" id="milestone_no" name="milestone_no" value="<%= milestone.MilestoneNo || '' %>" min="1" placeholder="Optional">
        </div>
      </div>
    </div>
    
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        <%= isEdit ? 'Update Milestone' : 'Add Milestone' %>
      </button>
      <a href="/portal/milestones" class="btn btn-outline">Cancel</a>
    </div>
  </form>
</div>

<%- include('../../partials/portal-footer') %>
