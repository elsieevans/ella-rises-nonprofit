<%- include('../../partials/portal-header', { currentPage: 'milestones', pageTitle: milestone.MilestoneTitle }) %>

<div class="page-actions">
  <a href="/portal/milestones" class="btn btn-outline">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
    Back to Milestones
  </a>
  <a href="/portal/milestones/view/<%= encodeURIComponent(milestone.MilestoneTitle) %>" class="btn btn-secondary">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
    View All Achievers
  </a>
  <% if (user && user.role === 'Admin') { %>
    <a href="/portal/milestones/<%= milestone.MilestoneID %>/edit" class="btn btn-primary">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
      Edit
    </a>
  <% } %>
</div>

<div class="detail-grid detail-grid--two">
  <!-- Milestone Info Card -->
  <div class="detail-card">
    <div class="milestone-detail-header">
      <div class="milestone-badge-large">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
      </div>
      <div>
        <h2><%= milestone.MilestoneTitle %></h2>
      </div>
    </div>
    
    <div class="detail-section">
      <dl class="detail-list">
        <dt>Participant</dt>
        <dd>
          <% if (milestone.ParticipantFirstName) { %>
            <a href="/portal/participants/<%= milestone.ParticipantID %>">
              <%= milestone.ParticipantFirstName %> <%= milestone.ParticipantLastName %>
            </a>
          <% } else { %>
            Not assigned
          <% } %>
        </dd>
        <dt>Date</dt>
        <dd><%= milestone.MilestoneDate ? new Date(milestone.MilestoneDate).toLocaleDateString() : 'Not set' %></dd>
        <% if (milestone.MilestoneNo) { %>
          <dt>Milestone Number</dt>
          <dd><%= milestone.MilestoneNo %></dd>
        <% } %>
      </dl>
    </div>
  </div>
</div>

<% if (user && user.role === 'Admin') { %>
<div class="danger-zone">
  <h3>Danger Zone</h3>
  <p>Deleting this milestone record cannot be undone.</p>
  <form action="/portal/milestones/<%= milestone.MilestoneID %>/delete" method="POST" onsubmit="return confirm('Are you sure you want to delete this milestone record?')">
    <button type="submit" class="btn btn-danger">Delete Milestone</button>
  </form>
</div>
<% } %>

<%- include('../../partials/portal-footer') %>

